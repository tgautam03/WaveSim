<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Finite Difference Method · WaveSim</title><meta name="title" content="Finite Difference Method · WaveSim"/><meta property="og:title" content="Finite Difference Method · WaveSim"/><meta property="twitter:title" content="Finite Difference Method · WaveSim"/><meta name="description" content="Documentation for WaveSim."/><meta property="og:description" content="Documentation for WaveSim."/><meta property="twitter:description" content="Documentation for WaveSim."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WaveSim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">1D Wave Equation</span><ul><li class="is-active"><a class="tocitem" href>Finite Difference Method</a><ul class="internal"><li><a class="tocitem" href="#Differential-to-Difference-Equation"><span>Differential to Difference Equation</span></a></li><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li></ul></li><li><a class="tocitem" href="../accuracy/">Simulation Accuracy</a></li></ul></li><li><span class="tocitem">2D Wave Equation</span><ul><li><a class="tocitem" href="../../2d_wave/2d_FDM/">Finite Difference Method</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">1D Wave Equation</a></li><li class="is-active"><a href>Finite Difference Method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Finite Difference Method</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tgautam03/WaveSim" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tgautam03/WaveSim/blob/master/docs/src/1d_wave/1d_FDM.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Finite-Difference-Method"><a class="docs-heading-anchor" href="#Finite-Difference-Method">Finite Difference Method</a><a id="Finite-Difference-Method-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Difference-Method" title="Permalink"></a></h1><p>Given the Wave Equation, we want to evaluate <span>$u(x,t)$</span> for <span>$0 \le x \le x_n$</span> and <span>$0 \le t \le t_n$</span>. For simplicity, let&#39;s set <span>$x_n=1$</span> and <span>$t_n=1$</span>. Right now the domain is continuous and solving the Wave Equation analytically would be quite challenging. This is where we could use Numerical Methods like Finite Difference Method. The very first step is to discretize the domain into finite number of points. </p><p>To keep things simple, I have picked 11 points (each) to represent the <span>$x$</span> and <span>$t$</span> dimensions. This transforms the problem where we now have to just evaluate <span>$u$</span> at these 121 discrete points. Remember that we have to pre-define boundary and initial conditions, which leaves the number of unknown points to 90 (see Figure 1 for details). We will satisfy the Wave Equation at these points and get the value of <span>$u$</span>.</p><hr/><div class="imgcap">
  <img src="https://raw.githubusercontent.com/tgautam03/WaveSim/master/docs/src/img/1d_wave/grid.png" alt="this slowpoke moves"  width="800"/>
  <div class="thecap">Figure 1: Discretized grid with green shaded points showing locations where value of u is known. </div>
</div><hr/><h2 id="Differential-to-Difference-Equation"><a class="docs-heading-anchor" href="#Differential-to-Difference-Equation">Differential to Difference Equation</a><a id="Differential-to-Difference-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-to-Difference-Equation" title="Permalink"></a></h2><p>Partial Differential Equations are represented in the continuous domain, but we just discretized our domain into finite number of points. This is where we need to transform our differential equation into a difference equation (which is the discrete version of a differential equation). </p><p>Taylor Series is a way of approximating a function around some value <span>$x$</span> using the derivatives of that function </p><p class="math-container">\[f(x+dx)=f(x)+dx \frac{df}{dx}\big(x\big)+\frac{dx^2}{2!} \frac{d^2f}{dx^2}\big(x\big)+\frac{dx^3}{3!} \frac{d^3f}{dx^3}\big(x\big)+\cdots \tag{1}\]</p><p>Looking at the Wave Equation, we can see that it has 2nd order derivatives in time and space.</p><p class="math-container">\[\frac{\partial^2 u(x,t)}{\partial t^2} = c^2 \bigg[\frac{\partial^2 u(x,t)}{\partial x^2} \bigg] + s(x,t) \tag{2}\]</p><p>With Taylor Series we can approximate both <span>$\frac{\partial^2 u(x,t)}{\partial t^2}$</span> and <span>$\frac{\partial^2 u(x,t)}{\partial x^2}$</span> as follows</p><p class="math-container">\[u(x+dx, t)=u(x, t)+dx \frac{du}{dx}\big(x,t\big)+\frac{dx^2}{2!} \frac{d^2u}{dx^2}\big(x,t\big)+\frac{dx^3}{3!} \frac{d^3u}{dx^3}\big(x,t\big)+\cdots \tag{3a}\]</p><p class="math-container">\[u(x-dx, t)=u(x, t)-dx \frac{du}{dx}\big(x, t\big)+\frac{dx^2}{2!} \frac{d^2u}{dx^2}\big(x, t\big)-\frac{dx^3}{3!} \frac{d^3u}{dx^3}\big(x, t\big)+\cdots \tag{3b}\]</p><p>Adding equations <span>$(3a)$</span> and <span>$(3b)$</span>, we get</p><p class="math-container">\[\frac{u(x+dx, t) - 2u(x, t)+ u(x-dx, t)}{dx^2}= \frac{d^2u}{dx^2}\big(x, t\big)+2\frac{dx^2}{4!} \frac{d^4u}{dx^4}\big(x, t\big)+\cdots \tag{3}\]</p><p>Similarly for partial derivative with respect to <span>$t$</span>, we can write</p><p class="math-container">\[\frac{u(x, t+dt) - 2u(x, t)+ u(x, t-dt)}{dt^2}= \frac{d^2u}{dt^2}\big(x,t\big)+2\frac{dt^2}{4!} \frac{d^4u}{dt^4}\big(x, t\big)+\cdots \tag{4}\]</p><p>We can ignore the 4th derivative term in equations <span>$(3)$</span> and <span>$(4)$</span>, as long as we acknowledge that our approximation is <span>$\mathcal{O}(dx^2)$</span> and <span>$\mathcal{O}(dt^2)$</span> accurate respectively (commonly known as 2nd order accuracy). Plugging the approximation to the derivatives into the differential equation, we get a difference equation</p><p class="math-container">\[\frac{u(x, t+dt) - 2u(x, t)+ u(x, t-dt)}{dt^2} = c^2 \bigg[\frac{u(x+dx, t) - 2u(x, t)+ u(x-dx, t)}{dx^2} \bigg] + s(x,t) \tag{5a}\]</p><p>In Figure 2, we can see how this ties back to our discretized grid. Difference equation <span>$(5a)$</span> can also be written more succintly as</p><p class="math-container">\[\frac{u_{i}^{j+1} - 2u_{i}^{j}+ u_{i}^{j-1}}{dt^2} = c^2 \bigg[\frac{u_{i+1}^{j} - 2u_i^j+ u_{i-1}^j}{dx^2} \bigg] + s_i^j \tag{5}\]</p><blockquote><p>Note that I have represented the space dimension in the subscript and the time dimension in the superscript.</p></blockquote><hr/><div class="imgcap">
  <img src="https://raw.githubusercontent.com/tgautam03/WaveSim/master/docs/src/img/1d_wave/Difference_eq_pts.png" alt="this slowpoke moves"  width="800"/>
  <div class="thecap">Figure 2: Connecting Discretized grid to the difference equations. </div>
</div><hr/><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><p>If we look carefully, we can solve equation <span>$(5)$</span> as an extrapolation problem. All we have to do is isolate the future <span>$u$</span> i.e. <span>$u_i^{j+1}$</span> on the left hand side and get it&#39;s value by evaluating the remaining right hand side expression.</p><p class="math-container">\[u_{i}^{j+1} = c^2 \frac{dt^2}{dx^2} \bigg[u_{i+1}^{j} - 2u_i^j+ u_{i-1}^j \bigg] + 2u_{i}^{j} - u_{i}^{j-1} + s_i^j \tag{5}\]</p><pre><code class="language-julia hljs"># Pressure Field at p(x,t)
p = zeros(nx)
# Pressure Field at p(x,t-dt)
p_prev = zeros(nx)
# Pressure Field at p(x,t+dt)
p_next = zeros(nx)
# Solution at each step
p_sols = zeros(nt,nx)

  # Looping over time
  for it in range(start=2, stop=nt)
      # Looping over Space
      for ix in range(start=2, stop=nx-1)
          # Evaluating 2nd derivative wrt x
          d2p_dx2 = p[ix+1] - 2*p[ix] + p[ix-1]
          # Updating Solution
          if ix == isrc
              p_next[ix] = (c*dt/dx)^2 * d2p_dx2 + 2*p[ix] - p_prev[ix] + dt^2 * src[it]
          else
              p_next[ix] = (c*dt/dx)^2 * d2p_dx2 + 2*p[ix] - p_prev[ix]
          end
      end
  
      # Current Sol becomes Previous Sol
      p_prev[:] = p[:]
      # Next Sol becomes Current Sol
      p[:] = p_next[:]
  
      # Storing solutions at each time step
      p_sols[it,:] = p
  end

  return p_sols</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../accuracy/">Simulation Accuracy »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Thursday 30 May 2024 19:00">Thursday 30 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
